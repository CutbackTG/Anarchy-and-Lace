{% extends "base.html" %}
{% load static %}

{% block content %}
<section class="pd">
  {# Amazon-style gallery #}
  <div class="pd-gallery glass-panel">

    {# Viewer controls #}
    <div class="pd-viewerbar" aria-label="Image view controls">
      <button type="button" class="pd-viewerbtn is-active" data-mode="fit">Fit</button>
      <button type="button" class="pd-viewerbtn" data-mode="fill">Fill</button>
    </div>

    {# Main viewer (default is FIT, so no classes needed) #}
    <div class="pd-main" aria-label="Main product image viewer">
      {% with first=product.images.first %}
        {% if first %}
          <img
            id="pdMainImg"
            class="pd-main-img"
            src="{{ first.image.url }}"
            alt="{{ product.name }}"
            loading="eager"
          />
        {% else %}
          <div class="pd-main-placeholder">No image yet</div>
        {% endif %}
      {% endwith %}
    </div>

    {# Thumbnails #}
    {% if product.images.count %}
      <div class="pd-thumbs" aria-label="Product image thumbnails">
        {% for img in product.images.all %}
          <button
            class="pd-thumb"
            type="button"
            data-src="{{ img.image.url }}"
            aria-label="View image {{ forloop.counter }}"
          >
            <img
              src="{{ img.image.url }}"
              alt="{{ product.name }} thumbnail {{ forloop.counter }}"
              loading="lazy"
            />
          </button>
        {% endfor %}
      </div>
    {% endif %}

  </div>

  {# Product info #}
  <div class="pd-info glass-panel">
    <h1 class="pd-title">{{ product.name }}</h1>
    <p class="pd-price">Â£{{ product.price }}</p>

    {% if product.description %}
      <p class="pd-desc">{{ product.description }}</p>
    {% endif %}

    <ul class="pd-meta">
      {% if product.fabric_origin %}
        <li><strong>Fabric:</strong> {{ product.fabric_origin }}</li>
      {% endif %}
      <li><strong>Condition:</strong> {{ product.get_condition_grade_display }}</li>
      {% if product.size %}
        <li><strong>Size:</strong> {{ product.size }}</li>
      {% endif %}
    </ul>

    <div class="pd-actions">
      <button class="button button--gold" type="button">Add to cart</button>
      {# <button class="button" type="button">Add to wishlist</button> added for later development #}
    </div>
  </div>
</section>

{# Keep JS at end so DOM exists before it runs #}
<script src="{% static 'js/product_detail.js' %}"></script>
{% endblock %}
